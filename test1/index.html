
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <style>
      /*（本次新增的版本）*/
      :root {--主題色: #7F552F;--走馬燈文字色: #edff66;}
      * {margin: 0;padding: 0;box-sizing: border-box;font-family: "Microsoft JhengHei", Arial, sans-serif;}

      /* 上拉顯示logo位 下拉隱藏 */
      body{margin-top: 80px;}
      .logo-container {
        height: 50px;
        width: 100%;
        background-color: var(--主題色);
        display: flex;
        justify-content: center;
        align-items: center;
        position: fixed;
        top: 0;
        z-index: 11;
        transition: .5s;
        overflow: hidden;
      }

      .logo {color: white;font-size: 24px;font-weight: bold;}
      .logo img {
        height: 50px;
        width: auto;
        object-fit: contain;
      }

      /* 回頂鍵 */
      .scroll-top {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background: var(--主題色);
        color: white;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: none;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
      }

      /* 走馬燈 */
      .marquee-container {
        height: 30px;
        width: 100%;
        position: fixed;
        top: 50px;
        overflow: hidden;
        background: #343434;
        z-index: 10;
        transition: 0.5s;
      }
      .marquee-container:hover .marquee-content {animation-play-state: paused;}
      .marquee-content {
        position: absolute;
        width: 100%;
        display: flex;
        flex-direction: column;
        transition: transform 0.5s ease-in-out;
      }
      .marquee-item {
        padding: 5px;
        text-align: center;
        height: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .marquee-item a {text-decoration: none;color: var(--走馬燈文字色);}
      .marquee-item a:hover {text-decoration: underline;}
      .close-marquee {
        position: absolute;
        right: 10px;
        top: 5px;
        cursor: pointer;
        z-index: 2;
      }

      /* 產品展示 */
      .image-container {
        width: 100%;
        text-align: center;
      }
      .responsive-image {
        max-width: 100%;
        height: auto;
        display: block;
        margin: 0 auto;
      }
      @media (min-width: 768px) {
        .responsive-image,
        .輪播圖,
        .image-container iframe {
          height: auto;
          width: 50%;
          max-width: 760px;
        }
      }
      .image-container iframe {
        height: auto;
        min-height: 300px;
        aspect-ratio: 16/9;
      }

      .company-intro {
        width: 90%;
        max-width: 760px;
        margin: 20px auto;
        padding: 20px;
        line-height: 2;
        text-align: center;
        white-space: pre-line;
      }

      .contact-section {
        width: auto;
        margin: 0 2%;
        padding: 20px;
        line-height: 2;
      }
            .contact-title {
        font-size: 24px;
        height: 50px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .toggle-btn {cursor: pointer;font-size: 24px;}
      .contact-content {
        height: 0;
        overflow: hidden;
        transition: height 0.3s ease-in-out;
      }

      /* 輪播圖 */
      .輪播圖 {
        position: relative;
        overflow: hidden;
        margin: auto;
      }
      .輪播圖-images {
        display: flex;
        transition: transform 0.5s ease-in-out;
        width: 100%;
      }
      .輪播圖-images img {
        object-fit: cover;
        width: 100%;
        height: auto;
      }
      .輪播圖 button {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        background-color: rgba(0, 0, 0, 0);
        border: none;
        cursor: pointer;
        z-index: 10;
        width: 40%;
        height: 80%;
      }
      .輪播圖 button.prev {left: 0px;}
      .輪播圖 button.next {right: 0px;}

      /* line圖示 */
      .social-links {margin: 20px;}
      .line-icon {width: 40px;height: 40px;}
      .line-icon:hover > path {fill: #00B900;}

      .copyright {
        text-align: center;
        padding: 20px;
        background: #f8f8f8;
      }

      @keyframes scrollUp {
        0% {transform: translateY(100%);}
        100% {transform: translateY(-100%);}
      }

      /* admin */
      .btn {
        border: none;
        padding: 10px 20px;
        cursor: pointer;
        border-radius: 5px;
        margin-top: 10px;
        width: auto;
        text-align: center;
      }
      .section,
      nav {display: none;}
      nav {padding: 1%;}
      .active {display: block;}
      .container {
        max-width: 760px;
        margin: 2rem auto;
        padding: 0 1rem;
      }
    
      h1,h2,h3,label {
        display: block;
        margin-bottom: 0.5rem;
        color: var(--標題色);
      }
      input,
      select {
        width: 100%;
        padding: 0.8rem;
        border: 1px solid #ddd;
        border-radius: 5px;
        font-size: 1rem;
      }
    </style>

    <script src="https://code.jquery.com/jquery-3.7.0.js"></script>
    <script>
      $(document).ready(function () {
        // 初始化所有功能
        _顯示LogoIcon();
        _顯示內容(產品展示內容, '產品展示');
        _顯示內容(走馬燈內容, '走馬燈');
        _顯示內容(關於我們, '關於我們');
        _顯示內容(聯絡資訊, '聯絡資訊');
        _顯示內容(社交帳號, '社交帳號');
        _輪播圖動();
        _走馬燈動();
        _去後台();
      });
            function _顯示內容(data, sel) {
        let cont = 0;
        for (let 內容 of data) {
          let all內容;

          /***************** 走馬燈 ******************/
          if (sel === '走馬燈') {
            all內容 = `<div class="marquee-item"><a href="${內容.url}" target="_blank" rel="noopener noreferrer">${內容.字}</a></div>`;
          }
          /***************** 產品展示 ******************/
          else if (sel === '產品展示') {
            // YouTube 影片處理
            if (內容.產品展示圖 && 內容.產品展示圖.includes('youtube.com')) {
              all內容 = $(`<div class="image-container">
                <iframe 
                  src="${內容.產品展示圖}?enablejsapi=1&autoplay=0"
                  frameborder="0"
                  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                  allowfullscreen>
                </iframe>
              </div>`);
              
              // 添加 Intersection Observer 來控制視頻播放
              const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                  const iframe = entry.target.querySelector('iframe');
                  if (entry.isIntersecting) {
                    iframe.contentWindow.postMessage('{"event":"command","func":"playVideo","args":""}', '*');
                  } else {
                    iframe.contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}', '*');
                  }
                });
              }, { threshold: 0.5 });
              
              observer.observe(all內容[0]);
            }
            // 輪播圖處理
            else if (內容.產品展示圖 && 內容.產品展示圖.includes(',')) {
              let 整組輪播圖 = 內容.產品展示圖.split(',');
              let $輪播圖容器 = $('<div class="輪播圖-images"></div>');

              for (let i = 0; i < 整組輪播圖.length; i++) {
                let $輪圖 = $(`<img class="responsive-image" src="${整組輪播圖[i]}" loading="lazy">`);
                $輪播圖容器.append($輪圖);
              }
              all內容 = $('<div class="輪播圖"><button class="prev"></button><button class="next"></button></div>').append($輪播圖容器);
            }
            // 一般圖片處理
            else if (內容.圖) {
              let $內容圖 = $(`<img class="responsive-image" src="${內容.圖}" loading="lazy">`);
              let 單個內容 = $內容圖;
              if (內容.url) {
                單個內容 = $(`<a href="${內容.url}" target="_blank" rel="noopener noreferrer"></a>`).append($內容圖);
              }
              all內容 = $(`<div class="image-container"></div>`).append(單個內容);
              $內容圖.on("error", function () {
                all內容.remove();
              });
            }
          }
          /***************** 關於我們 ******************/
          else if (sel === '關於我們') {
            all內容 = `<p>${內容.字}</p>`;
          }
          /***************** 聯絡資訊 ******************/
          else if (sel === '聯絡資訊') {
            all內容 = `<p>${內容.字}</p>`;
          }
          /***************** 社交帳號 ******************/
          else if (sel === '社交帳號') {
            all內容 = 內容.html;
          }

          if (all內容) {
            $(`#${sel}`).append(all內容);
          }
        }
      }

      // 關走馬燈
      function closeMarquee() {
        document.getElementById('marqueeContainer').style.display = 'none';
      }

      // 走馬燈功能
      function _走馬燈動() {
        const $content = $('.marquee-content');
        const $items = $('.marquee-item');
        if (!$items.length) return;

        const itemHeight = $items.outerHeight();
        const itemCount = $items.length;
        let currentIndex = 0;
        let isVisible = true;

        const observer = new IntersectionObserver((entries) => {
          isVisible = entries[0].isIntersecting;
        });
        
        observer.observe($content[0]);

        function scrollMarquee() {
          if (!isVisible) return;
          currentIndex = (currentIndex + 1) % itemCount;
          $content.css('transform', `translateY(-${itemHeight * currentIndex}px)`);
        }

        const intervalId = setInterval(scrollMarquee, 1500);

        $content.hover(
          () => clearInterval(intervalId),
          () => setInterval(scrollMarquee, 1500)
        );
      }
            // 輪播圖功能
      function _輪播圖動() {
        const images = document.querySelector('.輪播圖-images');
        if (!images) return;

        const prevButton = document.querySelector('.prev');
        const nextButton = document.querySelector('.next');
        let currentIndex = 0;
        const imageCount = images.children.length;
        let autoPlayInterval;
        let isTransitioning = false;

        function updateCarousel() {
          if (isTransitioning) return;
          isTransitioning = true;
          
          const containerWidth = images.parentElement.clientWidth;
          const offset = -currentIndex * containerWidth;
          
          images.style.transform = `translateX(${offset}px)`;
          
          setTimeout(() => {
            isTransitioning = false;
          }, 500);
        }

        function nextSlide() {
          currentIndex = (currentIndex + 1) % imageCount;
          updateCarousel();
        }

        function prevSlide() {
          currentIndex = (currentIndex - 1 + imageCount) % imageCount;
          updateCarousel();
        }

        // 觸控支援
        let touchStartX = 0;
        let touchEndX = 0;

        images.addEventListener('touchstart', e => {
          touchStartX = e.touches[0].clientX;
        });

        images.addEventListener('touchend', e => {
          touchEndX = e.changedTouches[0].clientX;
          const diff = touchStartX - touchEndX;

          if (Math.abs(diff) > 50) {
            if (diff > 0) {
              nextSlide();
            } else {
              prevSlide();
            }
          }
        });

        prevButton?.addEventListener('click', () => {
          clearInterval(autoPlayInterval);
          prevSlide();
          autoPlayInterval = setInterval(nextSlide, 3000);
        });

        nextButton?.addEventListener('click', () => {
          clearInterval(autoPlayInterval);
          nextSlide();
          autoPlayInterval = setInterval(nextSlide, 3000);
        });

        autoPlayInterval = setInterval(nextSlide, 3000);
        window.addEventListener('resize', updateCarousel);
        updateCarousel();
      }

      function _顯示LogoIcon() {
        const logoImage = "A-頁首LOGO.png";
        const newFavicon = "B-Favicon分頁圖示.png";

        $("#logo").attr("src", logoImage).on("error", function () {
          $(this).attr("src", defaultImage);
        });

        let $favicon = $("link[rel='icon'], link[rel='shortcut icon'], link[rel='alternate icon'], link[rel='apple-touch-icon']");
        if ($favicon.length) {
          $favicon.attr("href", newFavicon).attr("type", "image/x-icon");
        } else {
          $("head").append(`<link rel="icon" type="image/x-icon" href="${newFavicon}">`);
        }
      }

      function _去後台() {
        admin明文 = false;
        if ((location.href).indexOf('???') != -1) admin明文 = decodeURIComponent(location.href.split('???')[1]);
        if (sha256(admin明文) == adp) $('nav').addClass('active');
      }

      function _導航換頁(page) {
        $('.section').removeClass('active');
        $(`#${page}page`).addClass('active');
      }

      // 開闢聯絡卡
      function toggleContact() {
        const content = document.getElementById('聯絡資訊');
        const btn = document.querySelector('.toggle-btn');

        if (content.style.height === '0px' || content.style.height === '') {
          content.style.height = 'auto';
          const height = content.offsetHeight + 'px';
          content.style.height = '0px';
          setTimeout(() => { content.style.height = height; }, 0);
          btn.textContent = '-';
        } else {
          content.style.height = content.offsetHeight + 'px';
          setTimeout(() => { content.style.height = '0px'; }, 0);
          btn.textContent = '+';
        }
      }

      // 回頁頂
      function scrollToTop() {
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }

      let lastScrollTop = 0;
      let isScrollingUp = false;

      window.addEventListener('scroll', function() {
        let currentScrollTop = window.pageYOffset || document.documentElement.scrollTop;
        if (currentScrollTop < lastScrollTop) {
          isScrollingUp = true;
        } else {
          isScrollingUp = false;
        }
        lastScrollTop = currentScrollTop;
        toggleScrollTopButton();
      });

      function toggleScrollTopButton() {
        const scrollTopButton = document.getElementById('scrollTop');
        const displayThreshold = 200;
        if (isScrollingUp && lastScrollTop > displayThreshold) {
          scrollTopButton.style.display = 'flex';
          $('.logo-container').css('top', '0px');
          $('.marquee-container').css('top', '50px');
        } else {
          scrollTopButton.style.display = 'none';
          $('.logo-container').css('top', '-50px');
          $('.marquee-container').css('top', '-80px');
        }
        if (lastScrollTop < 20) {
          $('.logo-container').css('top', '0px');
          $('.marquee-container').css('top', '50px');
        }
      }
    </script>
    <title>6明星網紅首選！接髮+染髮只要4,999元｜韓哥Hange接髮｜台北市西門町</title>

    <meta name="description" content="西門高質感接髮Hange韓哥，百萬級強榜王者名師。台北縮毛矯正專家。5星級超高接髮滿意度，120%的耐心諮詢服務。10多年專精接髮豐富經驗，頭髮任何問題問韓哥就對了。獨家接髮技術，專門為妳服務。獨家髮束排列，不怕脫落，接髮持久耐用。給我2小時，讓妳短髮瞬變長髮美女正妹，變美真的很簡單。">

    <meta content="韓哥Hange接髮" name="copyright">

    <meta property="og:site_name" content="韓哥Hange接髮">
    <meta property="og:title" content="明星網紅首選！接髮+染髮只要4,999元｜韓哥Hange接髮｜台北市西門町">
    <meta property="og:description" content="西門高質感接髮Hange韓哥，百萬級強榜王者名師。台北縮毛矯正專家。5星級超高接髮滿意度，120%的耐心諮詢服務。10多年專精接髮豐富經驗，頭髮任何問題問韓哥就對了。獨家接髮技術，專門為妳服務。獨家髮束排列，不怕脫落，接髮持久耐用。給我2小時，讓妳短髮瞬變長髮美女正妹，變美真的很簡單。">

    <meta property="og:url" content="https://huokeads.github.io/han">

    <meta property="og:image" content="https://huokeads.github.io/han/C-og-image.jpg">
    <meta property="og:image:alt" content="明星網紅首選！接髮+染髮只要4,999元｜韓哥Hange接髮｜台北市西門町">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:type" content="website">
    <meta property="fb:app_id" content="你的FacebookAppID">
  </head>
  
  <body>
    <!-- Logo區域 -->
    <div class="logo-container">
      <div class="logo">
        <img id="logo" alt="韓哥Hange接髮">
      </div>
    </div>

    <!-- 走馬燈 -->
    <div id="marqueeContainer" class="marquee-container">
      <div class="marquee-content" id="走馬燈">
        <!-- 走馬燈內容會由 JavaScript 動態插入 -->
      </div>
      <div class="close-marquee" onclick="closeMarquee()">✕</div>
    </div>

    <!-- 主要內容區 -->
    <main>
      <!-- 產品展示區 -->
      <div id="產品展示">
        <!-- 產品展示內容會由 JavaScript 動態插入 -->
      </div>

      <!-- 關於我們 -->
      <div class="company-intro" id="關於我們">
        <!-- 關於我們內容會由 JavaScript 動態插入 -->
      </div>

      <!-- 聯絡資訊 -->
      <div class="contact-section">
        <div class="contact-title">
          <span>聯絡資訊</span>
          <span class="toggle-btn" onclick="toggleContact()">+</span>
        </div>
        <div class="contact-content" id="聯絡資訊">
          <!-- 聯絡資訊內容會由 JavaScript 動態插入 -->
        </div>
      </div>

      <!-- 社交連結 -->
      <div class="social-links" id="社交帳號">
        <!-- 社交帳號內容會由 JavaScript 動態插入 -->
      </div>

      <!-- 版權資訊 -->
      <div class="copyright">
        <p>© 2024 韓哥Hange接髮 版權所有</p>
      </div>
    </main>

    <!-- 回到頂部按鈕 -->
    <div id="scrollTop" class="scroll-top" onclick="scrollToTop()">↑</div>

    <!-- 後台管理介面 -->
    <nav>
      <button class="btn" onclick="_導航換頁('走馬燈')">走馬燈</button>
      <button class="btn" onclick="_導航換頁('產品展示')">產品展示</button>
      <button class="btn" onclick="_導航換頁('關於我們')">關於我們</button>
      <button class="btn" onclick="_導航換頁('聯絡資訊')">聯絡資訊</button>
      <button class="btn" onclick="_導航換頁('社交帳號')">社交帳號</button>

      <!-- 後台頁面 -->
      <div id="走馬燈page" class="section">
        <h2>走馬燈管理</h2>
        <!-- 走馬燈管理內容 -->
      </div>

      <div id="產品展示page" class="section">
        <h2>產品展示管理</h2>
        <!-- 產品展示管理內容 -->
      </div>

      <div id="關於我們page" class="section">
        <h2>關於我們管理</h2>
        <!-- 關於我們管理內容 -->
      </div>

      <div id="聯絡資訊page" class="section">
        <h2>聯絡資訊管理</h2>
        <!-- 聯絡資訊管理內容 -->
      </div>

      <div id="社交帳號page" class="section">
        <h2>社交帳號管理</h2>
        <!-- 社交帳號管理內容 -->
      </div>
    </nav>
  </body>
</html>
